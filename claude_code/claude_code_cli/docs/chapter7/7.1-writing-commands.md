# 7.1 如何寫好命令？

## 簡介

撰寫清晰、具體的命令是有效使用 Claude Code CLI 的關鍵。好的命令能讓 Claude 準確理解你的需求，生成高品質的代碼。本節將分享提示工程（Prompt Engineering）的技巧和最佳實踐。

## 基本原則

### 1. 明確具體

**不好的範例：**
```bash
claude "寫個函數"
```

**好的範例：**
```bash
claude "建立一個 JavaScript 函數 calculateTax，接收金額（number）和稅率（number），回傳含稅金額，包含輸入驗證"
```

### 2. 提供上下文

**不好的範例：**
```bash
claude "建立 API"
```

**好的範例：**
```bash
claude "在這個 Express 專案中，建立一個 RESTful API 端點 GET /api/users/:id，從 MongoDB 獲取用戶資料，包含錯誤處理"
```

### 3. 指定格式和風格

```bash
claude "建立 React 元件 UserCard，使用：
- Functional component
- TypeScript
- Tailwind CSS
- Props: name, email, avatar"
```

## 命令結構

### 基本結構

```bash
claude "[動作] [對象] [要求/限制] [格式/風格]"
```

**範例：**
```bash
claude "建立一個排序函數，使用快速排序演算法，包含時間複雜度註解，使用 TypeScript"
#       ↑動作   ↑對象           ↑要求                    ↑限制                ↑格式
```

### 詳細結構範本

```bash
claude "
[主要任務]

包含：
- [功能 1]
- [功能 2]
- [功能 3]

技術要求：
- [技術 1]
- [技術 2]

注意事項：
- [注意事項 1]
- [注意事項 2]
"
```

## 實用範例

### 代碼生成

```bash
# 範例 1：建立資料模型
claude "建立 Mongoose User 模型，包含：
- username（字串，必填，唯一）
- email（字串，必填，唯一，email 格式驗證）
- password（字串，必填，最少 8 字元）
- role（字串，預設 'user'，只能是 'user' 或 'admin'）
- createdAt（日期，自動）
添加適當的索引和 pre-save hook 用於密碼加密"
```

```bash
# 範例 2：建立測試
claude "為 calculateDiscount 函數生成 Jest 測試，涵蓋：
- 正常情況（各種折扣率）
- 邊界值（0%, 100%）
- 錯誤情況（負數、超過 100%）
- 特殊情況（null, undefined）"
```

### 代碼分析

```bash
# 範例 1：安全性檢查
claude "分析 auth.js 的安全性，特別檢查：
- SQL/NoSQL 注入風險
- XSS 漏洞
- 敏感資訊洩漏
- 認證邏輯缺陷"
```

```bash
# 範例 2：效能分析
claude "分析 productController.js 的效能，找出：
- 資料庫查詢優化機會
- N+1 問題
- 不必要的運算
- 可以快取的部分"
```

### 代碼重構

```bash
# 範例 1：改善可讀性
claude "重構 paymentService.js，改善：
- 函數命名（使其更具描述性）
- 提取重複的邏輯
- 簡化巢狀的 if-else
- 添加有意義的註解"
```

```bash
# 範例 2：現代化代碼
claude "重構 utils.js，使用現代 JavaScript 語法：
- var → const/let
- 回調函數 → async/await
- 陣列操作使用 map/filter/reduce
- 使用解構賦值
- 使用樣板字串"
```

## 進階技巧

### 1. 使用範例

```bash
claude "建立一個類似下面範例的函數，但用於處理訂單：

範例：
function processUser(user) {
  validate(user);
  transform(user);
  return save(user);
}

要求：處理訂單，包含驗證、計算總額、儲存"
```

### 2. 參考現有代碼

```bash
claude "參考 user.controller.js 的風格和錯誤處理方式，建立 product.controller.js"
```

### 3. 指定設計模式

```bash
claude "使用工廠模式建立資料庫連線管理器，支援 MySQL 和 PostgreSQL"
```

### 4. 分步驟描述

```bash
claude "建立用戶註冊流程：
步驟 1: 驗證輸入（email 格式、密碼強度）
步驟 2: 檢查 email 是否已存在
步驟 3: 加密密碼（使用 bcrypt）
步驟 4: 建立用戶記錄
步驟 5: 發送驗證郵件
步驟 6: 回傳 JWT token"
```

### 5. 提供限制條件

```bash
claude "建立檔案上傳功能，限制：
- 檔案大小：最大 5MB
- 檔案類型：只允許圖片（jpg, png, webp）
- 檔案名稱：自動生成唯一名稱
- 儲存位置：使用 AWS S3"
```

## 常見場景

### 除錯協助

```bash
# 提供錯誤訊息
claude "這段代碼出現錯誤：[錯誤訊息]
請幫我找出問題並修復

[貼上代碼]"
```

### 學習新技術

```bash
claude "我想學習 React Hooks。請：
1. 解釋 useState 和 useEffect
2. 給我 3 個實用範例
3. 說明常見錯誤
4. 提供最佳實踐"
```

### 優化現有代碼

```bash
claude "優化這段代碼的效能：
[貼上代碼]

目標：
- 減少資料庫查詢次數
- 降低時間複雜度
- 保持可讀性"
```

## 避免的寫法

### ❌ 太模糊

```bash
claude "做一個網站"
claude "修復問題"
claude "讓它更好"
```

### ❌ 缺少上下文

```bash
claude "建立 API"  # 什麼 API？用什麼技術？
claude "寫測試"    # 測試什麼？用什麼框架？
```

### ❌ 一次要求太多

```bash
claude "建立完整的電商網站，包含前端、後端、資料庫、支付系統、推薦演算法、聊天機器人"
```

## 最佳實踐檢查清單

撰寫命令時，確認：

- [ ] 明確指定要做什麼
- [ ] 提供必要的上下文
- [ ] 說明技術要求
- [ ] 指定預期的輸出格式
- [ ] 提到特殊要求或限制
- [ ] 範圍適中（不要太大也不要太小）
- [ ] 包含範例（如果有幫助）
- [ ] 說明錯誤處理要求

## 範本集合

### 建立功能範本

```bash
claude "建立 [功能名稱]，包含：
功能：
- [功能 1]
- [功能 2]

技術棧：
- [技術 1]
- [技術 2]

要求：
- [要求 1]
- [要求 2]"
```

### 分析代碼範本

```bash
claude "分析 [檔案名稱]，檢查：
- [檢查項目 1]
- [檢查項目 2]
- [檢查項目 3]

提供具體的改進建議"
```

### 重構代碼範本

```bash
claude "重構 [檔案名稱]：
目標：
- [目標 1]
- [目標 2]

保持：
- [要保持的 1]
- [要保持的 2]"
```

## 常見問題

### Q: 命令太長會不會有問題？
A: 適度的長度是好的，Claude 能處理詳細的描述。但避免冗長重複。

### Q: 需要用英文嗎？
A: 不需要，Claude 支援多種語言，包括繁體中文。

### Q: 可以提供代碼片段嗎？
A: 可以！提供參考代碼能幫助 Claude 理解你的需求。

### Q: 如何處理 Claude 沒理解的情況？
A: 重新表述，提供更多細節，或使用互動模式多輪對話。

---

⏳ 內容持續補充中

## 導航

- **上一節**: [第七章：給初學者的建議](./README.md)
- **下一節**: [7.2 常見新手錯誤](./7.2-common-mistakes.md)
- **返回章節目錄**: [第七章目錄](./README.md)
- **返回首頁**: [教材首頁](../../README.md)
