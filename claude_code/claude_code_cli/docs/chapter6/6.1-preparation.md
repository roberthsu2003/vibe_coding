# 6.1 準備工作

## 簡介

在開始實戰練習之前，我們需要做好充分的準備工作。本節將引導你設定開發環境、安裝必要工具，並建立專案的基礎結構。完成這些準備後，你就可以順利進行後續的實戰練習了。

## 學習目標

完成本節後，你將能夠：
- ✅ 設定完整的開發環境
- ✅ 初始化專案結構
- ✅ 配置必要的工具和套件
- ✅ 理解專案的整體架構

## 環境需求

### 系統需求

| 項目 | 最低需求 | 建議 |
|------|---------|------|
| **作業系統** | macOS 10.15+ / Windows 10+ / Linux | 最新版本 |
| **Node.js** | 16.x | 18.x 或更高 |
| **npm** | 7.x | 9.x 或更高 |
| **記憶體** | 4GB | 8GB 或更高 |
| **硬碟空間** | 1GB | 5GB 或更高 |

### 必要工具

```bash
# 檢查 Node.js 版本
node --version  # 應該 >= 16.0.0

# 檢查 npm 版本
npm --version   # 應該 >= 7.0.0

# 如果版本太舊，更新 Node.js
# 方法 1: 使用 nvm
nvm install 18
nvm use 18

# 方法 2: 從官網下載
# https://nodejs.org/
```

### 安裝 Claude Code CLI

```bash
# 全域安裝
npm install -g @anthropic-ai/claude-code

# 驗證安裝
claude --version

# 設定 API Key
claude config set api-key YOUR_API_KEY

# 測試連線
claude "Hello, Claude!"
```

### 選用工具

```bash
# Git（版本控制）
git --version

# VSCode（程式碼編輯器）
code --version

# Docker（容器化，選用）
docker --version

# Postman 或 Insomnia（API 測試，選用）
```

## 專案初始化

### 步驟 1：建立專案目錄

```bash
# 建立專案目錄
mkdir todo-api-project
cd todo-api-project

# 初始化 Git
git init

# 建立 .gitignore
cat > .gitignore << EOF
node_modules/
.env
*.log
dist/
coverage/
.DS_Store
EOF
```

### 步驟 2：初始化 npm 專案

```bash
# 初始化 package.json
npm init -y

# 安裝基礎套件
npm install express dotenv

# 安裝開發工具
npm install --save-dev nodemon jest supertest

# 安裝 TypeScript（選用）
npm install --save-dev typescript @types/node @types/express ts-node
```

### 步驟 3：建立基本目錄結構

```bash
# 使用 Claude 建立專案結構
claude "建立一個 Express API 專案的目錄結構，包含：
- src/ 源代碼目錄
- tests/ 測試目錄
- docs/ 文檔目錄
- scripts/ 腳本目錄"
```

**預期的目錄結構：**
```
todo-api-project/
├── src/
│   ├── controllers/
│   ├── models/
│   ├── routes/
│   ├── middleware/
│   ├── utils/
│   └── app.js
├── tests/
│   ├── unit/
│   └── integration/
├── docs/
├── scripts/
├── .env.example
├── .gitignore
├── package.json
└── README.md
```

### 步驟 4：設定環境變數

```bash
# 建立 .env 範本
cat > .env.example << EOF
NODE_ENV=development
PORT=3000
DATABASE_URL=mongodb://localhost:27017/todo-db
JWT_SECRET=your-secret-key-here
EOF

# 複製並編輯實際的 .env
cp .env.example .env
```

**編輯 .env：**
```bash
# .env
NODE_ENV=development
PORT=3000
DATABASE_URL=mongodb://localhost:27017/todo-db
JWT_SECRET=generate-a-secure-random-key
```

### 步驟 5：配置 package.json scripts

```json
{
  "name": "todo-api-project",
  "version": "1.0.0",
  "description": "A RESTful API for managing todo items",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js",
    "dev": "nodemon src/app.js",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage"
  },
  "keywords": ["todo", "api", "express"],
  "author": "Your Name",
  "license": "MIT"
}
```

## 專案設定檔

### Jest 設定（測試框架）

```bash
# 建立 jest.config.js
cat > jest.config.js << 'EOF'
module.exports = {
  testEnvironment: 'node',
  coverageDirectory: 'coverage',
  collectCoverageFrom: [
    'src/**/*.js',
    '!src/app.js'
  ],
  testMatch: [
    '**/tests/**/*.test.js'
  ]
};
EOF
```

### ESLint 設定（程式碼檢查）

```bash
# 安裝 ESLint
npm install --save-dev eslint

# 初始化 ESLint
npx eslint --init

# 選擇：
# - How would you like to use ESLint? → To check syntax and find problems
# - What type of modules? → JavaScript modules (import/export)
# - Which framework? → None
# - Does your project use TypeScript? → No
# - Where does your code run? → Node
# - What format? → JavaScript
```

### Prettier 設定（程式碼格式化）

```bash
# 安裝 Prettier
npm install --save-dev prettier

# 建立 .prettierrc
cat > .prettierrc << EOF
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5"
}
EOF
```

## 驗證設定

### 建立測試檔案

```bash
# 使用 Claude 建立簡單的測試
claude "建立一個簡單的 Jest 測試檔案，測試 1+1=2" --output tests/sample.test.js
```

**tests/sample.test.js：**
```javascript
describe('Sample Test', () => {
  it('should pass basic test', () => {
    expect(1 + 1).toBe(2);
  });
});
```

### 執行測試

```bash
# 運行測試
npm test

# 預期輸出：
# PASS  tests/sample.test.js
#   Sample Test
#     ✓ should pass basic test (2 ms)
#
# Test Suites: 1 passed, 1 total
# Tests:       1 passed, 1 total
```

### 建立基本 Express 應用

```bash
# 使用 Claude 建立基本的 Express app
claude "建立一個基本的 Express 應用程式，包含：
- 載入 dotenv
- 基本的錯誤處理
- 健康檢查端點 /health
- 監聽指定 PORT" --output src/app.js
```

### 測試應用程式

```bash
# 啟動開發伺服器
npm run dev

# 在另一個終端機測試
curl http://localhost:3000/health

# 預期回應：
# {"status":"ok"}
```

## 資料庫設定（選用）

### 使用 MongoDB

```bash
# 安裝 MongoDB 驅動
npm install mongodb mongoose

# 或使用 Docker 快速啟動 MongoDB
docker run -d -p 27017:27017 --name mongodb mongo:latest
```

**建立資料庫連線：**
```bash
claude "建立 MongoDB 連線模組，使用 Mongoose，包含：
- 連線函數
- 錯誤處理
- 連線事件監聽" --output src/utils/database.js
```

### 使用 SQLite（更簡單的選項）

```bash
# 安裝 SQLite
npm install sqlite3

# 不需要額外的資料庫伺服器
```

## 專案文檔

### 建立 README

```bash
# 使用 Claude 生成 README
claude "為這個 Todo API 專案建立 README.md，包含：
- 專案簡介
- 功能列表
- 安裝步驟
- 使用方式
- API 端點說明（待補充）
- 開發指南" --output README.md
```

### 建立 API 文檔範本

```bash
# 建立 API 文檔目錄
mkdir -p docs/api

# 建立 API 文檔範本
cat > docs/api/README.md << EOF
# Todo API Documentation

## 端點列表

（將在後續章節填充）

### GET /api/todos
獲取所有待辦事項

### POST /api/todos
建立新的待辦事項

### PUT /api/todos/:id
更新待辦事項

### DELETE /api/todos/:id
刪除待辦事項
EOF
```

## 準備檢查清單

在開始下一節之前，確認以下項目：

- [ ] Node.js 和 npm 已安裝且版本正確
- [ ] Claude Code CLI 已安裝並設定 API Key
- [ ] 專案目錄已建立並初始化 Git
- [ ] npm 專案已初始化，基本套件已安裝
- [ ] 目錄結構已建立
- [ ] 環境變數已設定
- [ ] Jest 測試可以正常運行
- [ ] 基本的 Express 應用可以啟動
- [ ] README 和基本文檔已建立
- [ ] 程式碼檢查工具（ESLint/Prettier）已設定

## 常見問題

### Q: 我可以使用其他資料庫嗎？
A: 當然！你可以使用 PostgreSQL、MySQL 或任何你熟悉的資料庫。後續範例會以 MongoDB 為主，但概念相同。

### Q: 一定要用 TypeScript 嗎？
A: 不一定。本教學使用 JavaScript，但你可以選擇 TypeScript。

### Q: 專案結構可以不同嗎？
A: 可以！這只是建議的結構，你可以根據自己的喜好調整。

### Q: 需要安裝資料庫嗎？
A: 本章節資料庫是選用的，你可以先用記憶體儲存，或使用 SQLite 這類輕量選項。

## 故障排除

### npm install 失敗

```bash
# 清除快取
npm cache clean --force

# 刪除 node_modules 和 package-lock.json
rm -rf node_modules package-lock.json

# 重新安裝
npm install
```

### Claude CLI 無法連線

```bash
# 檢查 API Key
claude config get api-key

# 重新設定
claude config set api-key YOUR_API_KEY

# 測試連線
claude "test"
```

### Port 被佔用

```bash
# 查看佔用 3000 port 的程序
lsof -i :3000

# 停止該程序或更改 PORT
export PORT=3001
npm run dev
```

## 下一步

完成準備工作後，我們將開始建立實際的 API 功能！

---

⏳ 內容持續補充中

## 導航

- **上一節**: [第六章：實戰練習](./README.md)
- **下一節**: [6.2 建立 Express API](./6.2-express-api.md)
- **返回章節目錄**: [第六章目錄](./README.md)
- **返回首頁**: [教材首頁](../../README.md)
