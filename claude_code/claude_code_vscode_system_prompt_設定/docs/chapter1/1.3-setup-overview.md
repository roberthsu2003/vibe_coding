# 1.3 Claude Code 的設定方式概覽

## ⚙️ 設定層級概覽

Claude Code 提供 **VSCode 擴充套件** 和 **CLI 工具** 兩種使用方式,支援多種層級的系統提示設定。

> **💡 重要:** VSCode 擴充套件和 CLI 工具在設定方式上有所不同。CLI 提供更多進階設定選項。詳見 [2.4 VSCode vs CLI 差異](../chapter2/2.4-vscode-vs-cli.md)

### 📊 設定層級比較表 (VSCode 擴充套件)

| 設定類型 | 設定方式 | 影響範圍 | 優先級 | 適用情境 |
|:---------|:---------|:---------|:-------|:---------|
| **📁 專案層級** | `CLAUDE.md` 檔案 | 整個專案 | 高 | 專案特定規範 |
| **📂 資料夾層級** | 子資料夾內的 `CLAUDE.md` | 特定資料夾 | 最高 | 模組特定規則 |
| **⚙️ VS Code 設定** | `settings.json` | 使用者/工作區 | 中 | 通用偏好設定 |

### 🔧 CLI 工具額外支援

CLI 工具提供更多進階設定選項:

| 設定類型 | 設定方式 | 影響範圍 | 說明 |
|:---------|:---------|:---------|:-----|
| **🌐 全域 CLAUDE.md** | `~/.claude/CLAUDE.md` | 所有專案 | CLI 獨有,設定全域預設值 |
| **⚙️ 全域 settings.json** | `~/.claude/settings.json` | 所有專案 | CLI 的全域配置檔 |
| **📋 專案 settings.json** | `.claude/settings.json` | 當前專案 | CLI 的專案配置檔 |
| **⚡ 命令列參數** | `--append-system-prompt` | 單次執行 | 即時修改 System Prompt |
| **🎯 自訂指令** | `.claude/commands/` | 當前專案 | 封裝常用的 System Prompt |

---

## 🔍 優先級運作機制

### VSCode 擴充套件的優先級

當使用 VSCode 擴充套件時,設定載入順序:

```
1️⃣ 最內層資料夾的 CLAUDE.md (最高優先級)
    ↓
2️⃣ 向上層查找直到專案根目錄的 CLAUDE.md
    ↓
3️⃣ VS Code 工作區設定 (.vscode/settings.json)
    ↓
4️⃣ VS Code 使用者設定 (全域設定)
```

### CLI 工具的優先級

當使用 CLI 工具時,設定載入順序:

```
1️⃣ 命令列參數 --append-system-prompt (最高優先級)
    ↓
2️⃣ 最內層資料夾的 CLAUDE.md
    ↓
3️⃣ 向上層查找直到專案根目錄的 CLAUDE.md
    ↓
4️⃣ 專案 settings.json (.claude/settings.json)
    ↓
5️⃣ 全域 CLAUDE.md (~/.claude/CLAUDE.md)
    ↓
6️⃣ 全域 settings.json (~/.claude/settings.json)
```

### 📝 實際範例

假設您的專案結構如下:

```
project/
├── CLAUDE.md                    # 專案全域設定
├── .vscode/settings.json        # 工作區設定
├── src/
│   ├── admin/
│   │   └── CLAUDE.md           # admin 專屬設定
│   └── components/
│       └── Button.tsx
```

**當您編輯不同檔案時:**

| 編輯的檔案 | 套用的設定 |
|:----------|:----------|
| `src/admin/AdminPanel.tsx` | admin/CLAUDE.md + 專案根目錄 CLAUDE.md + 工作區設定 |
| `src/components/Button.tsx` | 專案根目錄 CLAUDE.md + 工作區設定 |
| 其他檔案 | 專案根目錄 CLAUDE.md + 工作區設定 |

---

## 🎯 各層級的最佳用途

### 1. 專案層級設定 (`CLAUDE.md`)

**適用於:**
- ✅ 專案的技術棧定義
- ✅ 整體編碼規範
- ✅ 專案架構說明
- ✅ 通用的最佳實踐

**範例:**
```markdown
# 專案設定

## 技術棧
- React 18 + TypeScript
- Tailwind CSS

## 編碼規範
- 使用 Function Components
- Props 使用解構賦值
```

---

### 2. 資料夾層級設定 (子資料夾的 `CLAUDE.md`)

**適用於:**
- ✅ 特定模組的規則
- ✅ 不同功能區塊的差異化需求
- ✅ 特殊的安全性要求
- ✅ 模組特定的測試規範

**範例:**
```markdown
# Admin 模組設定

## 安全性要求
- 所有操作需要權限檢查
- 敏感資料必須加密

## 日誌要求
- 記錄所有操作
- 包含使用者 ID 和時間戳記
```

---

### 3. VS Code 設定檔 (`settings.json`)

**適用於:**
- ✅ 個人偏好設定
- ✅ 編輯器行為設定
- ✅ 通用的開發工具設定
- ✅ 跨專案的共用設定

**範例:**
```json
{
  "claude-code.systemPrompt": "所有回答使用繁體中文",
  "editor.formatOnSave": true,
  "editor.defaultFormatter": "esbenp.prettier-vscode"
}
```

---

## 🔄 衝突處理規則

當不同層級的設定有衝突時,Claude Code 會:

1. **優先採用最內層的設定**
2. **合併不衝突的設定**
3. **保持設定的完整性**

### 衝突範例

**專案層級 CLAUDE.md:**
```markdown
- 註解使用英文
- 使用 2 空格縮排
```

**資料夾層級 CLAUDE.md:**
```markdown
- 註解使用繁體中文
```

**結果:** 編輯該資料夾內的檔案時
- ✅ 註解使用繁體中文 (資料夾層級覆蓋)
- ✅ 使用 2 空格縮排 (繼承專案層級)

---

## 🚀 快速開始建議

### 步驟 1: 從專案層級開始
在專案根目錄建立 `CLAUDE.md`,設定基本規範

### 步驟 2: 視需要加入資料夾層級設定
為特殊模組建立專屬的 `CLAUDE.md`

### 步驟 3: 調整個人偏好
在 VS Code 設定中加入個人偏好

---

## 💡 關鍵要點

> **階層化設定讓您可以在保持全域一致性的同時,為特定模組提供客製化規則。**

記住:
- 🎯 **專案層級** = 整體規範
- 📂 **資料夾層級** = 特殊需求
- ⚙️ **VS Code 設定** = 個人偏好

---

## 📚 下一步

現在您已經了解 Claude Code 的設定層級,接下來我們將深入學習如何實際設定:

- [第二章：專案層級設定](../chapter2/README.md) - 學習如何建立和使用 `CLAUDE.md`
- [第三章：資料夾層級設定](../chapter3/README.md) - 為不同模組建立專屬規則
- [第四章：實用範例集](../chapter4/README.md) - 各種技術棧的完整範例

## 導航

- **上一節**: [1.2 為什麼 System Prompt 很重要](./1.2-why-important.md)
- **下一章**: [第二章：專案層級設定](../chapter2/README.md)
- **返回**: [教材首頁](../../README.md)
